version: 2

defaults: &defaults
  docker:
    - image: circleci/rust:latest

jobs:
  tests:
    <<: *defaults
    steps:
      - checkout
      - run:
          command: cargo test

  linter:
    <<: *defaults
    steps:
      - checkout
      - run:
          command: "rustup component add rustfmt-preview"
      - run:
          command: "cargo fmt --all -- --check"

workflows:
  version: 2
  build_and_test:
    jobs:
      - tests
      - linter
